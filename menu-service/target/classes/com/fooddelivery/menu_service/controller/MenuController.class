// Source code is decompiled from a .class file using FernFlower decompiler (from Intellij IDEA).
package com.fooddelivery.menu_service.controller;

import com.fooddelivery.menu_service.entity.MenuItem;
import com.fooddelivery.menu_service.entity.Restaurant;
import com.fooddelivery.menu_service.repository.MenuItemRepository;
import com.fooddelivery.menu_service.repository.RestaurantRepository;
import java.util.List;
import lombok.Generated;
import org.springframework.http.ResponseEntity;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.PathVariable;
import org.springframework.web.bind.annotation.PostMapping;
import org.springframework.web.bind.annotation.RequestBody;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RestController;

@RestController
@RequestMapping({"/api/menu"})
public class MenuController {
   private final MenuItemRepository menuRepo;
   private final RestaurantRepository restaurantRepo;

   @GetMapping({"/{restaurantId}"})
   public List<MenuItem> getMenuByRestaurant(@PathVariable Long restaurantId) {
      return this.menuRepo.findByRestaurantId(restaurantId);
   }

   @PostMapping
   public ResponseEntity<?> addMenuItem(@RequestBody MenuItem menuItem) {
      if (menuItem.getRestaurant() != null && menuItem.getRestaurant().getId() != null) {
         Restaurant restaurant = (Restaurant)this.restaurantRepo.findById(menuItem.getRestaurant().getId()).orElseThrow(() -> {
            return new RuntimeException("Restaurant not found");
         });
         menuItem.setRestaurant(restaurant);
         return ResponseEntity.ok((MenuItem)this.menuRepo.save(menuItem));
      } else {
         return ResponseEntity.badRequest().body("Restaurant ID is required");
      }
   }

   @Generated
   public MenuController(final MenuItemRepository menuRepo, final RestaurantRepository restaurantRepo) {
      this.menuRepo = menuRepo;
      this.restaurantRepo = restaurantRepo;
   }
}
